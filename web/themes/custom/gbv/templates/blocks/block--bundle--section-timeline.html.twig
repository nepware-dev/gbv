{%
  set classes = [
    'block',
    'block-' ~ configuration.provider|clean_class,
    'block-' ~ plugin_id|clean_class,
    'section-timeline-wrapper'
  ]
%}
{%
    set contentClasses = [
        'content'
    ]
%}
<div{{ attributes.addClass(classes) }}>
  {{ title_prefix }}
  {% if label %}
    <h2{{ title_attributes }}>{{ label }}</h2>
  {% endif %}
  {{ title_suffix }}
  {% block content %}
    <div{{ content_attributes.addClass(contentClasses) }}>
        <ul class="timeline" id="timeline">
        </ul>
        <script src="https://code.jquery.com/jquery-3.4.0.min.js" integrity="sha256-BJeo0qm959uMBGb65z40ejJYGSgR7REI4+CW1fNKwOg=" crossorigin="anonymous"></script>
        <script>
            setTimeout(function(){
                var lastId,
                sideMenu = $("#timeline"),
                wrapper = $("#main-wrapper"),
                topMenuHeight = 300+1,

                dataTitles = wrapper.find("div[data-title]"),

                dataItems = dataTitles.map(function(){
                    var title = $(this).attr("data-title");
                    var id = $(this).attr("id");
                    var obj = {
                        title: title,
                        id: id ,
                    };
                    return obj; 
                });
                var i;
                const content = []
                for(i=0;i<dataItems.length;i++){
                var sectionContent = '<li> <span><span class="circle"><span class="inner-circle"></span></span></span>';
                sectionContent += '<a href= #'+ dataItems[i].id +' >'+ dataItems[i].title+' </a>'; 
                sectionContent += '</li>';
                content.push(sectionContent);
            }
            $('#timeline').html(content); 
                menuItems = sideMenu.find("a"),
                scrollItems = menuItems.map(function(){
                    var item = $($(this).attr("href"));
                        if (item.length) { return item; }
                });
                menuItems.click(function(e){
                    var href = $(this).attr("href"),
                    offsetTop = href === "#" ? 0 : $(href).offset().top-topMenuHeight+1;
                    $('html, body').stop().animate({ 
                        scrollTop: offsetTop
                    }, 850);
                    e.preventDefault();
                });
                $(window).scroll(function(){
                    var fromTop = $(this).scrollTop()+topMenuHeight;
                    var cur = scrollItems.map(function(){
                        if ($(this).offset().top < fromTop)
                        return this;
                    });
                    cur = cur[cur.length-1];
                    var id = cur && cur.length ? cur[0].id : "";
                    if (lastId !== id) {
                        lastId = id;
                        menuItems
                        .parent().removeClass("active")
                        .end().filter("[href='#"+id+"']").parent().addClass("active").css("display: inline-block");
                    }
                });
            }, 3000);
        </script>
    </div>
  {% endblock %}
</div>